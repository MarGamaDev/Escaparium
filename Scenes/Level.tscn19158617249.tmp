[gd_scene load_steps=31 format=3 uid="uid://ccgfl0nfuq3qv"]

[ext_resource type="Script" uid="uid://4dk0o0fcc8o5" path="res://Scripts/Management/GameManager.gd" id="1_or7tv"]
[ext_resource type="PackedScene" uid="uid://dwj6a3qcbnxfa" path="res://MAINROOM.tscn" id="1_vonw3"]
[ext_resource type="PackedScene" uid="uid://ddjov2hg4femu" path="res://Props/Screwdriver.tscn" id="3_oi3di"]
[ext_resource type="AudioStream" uid="uid://d16cx23gxe477" path="res://Sounds/ROOM AMBIENCE.mp3" id="5_f2txt"]
[ext_resource type="AudioStream" uid="uid://ch6b6g4ychi2y" path="res://Sounds/LOOP.mp3" id="6_1ainy"]
[ext_resource type="PackedScene" uid="uid://cfyrpvba8rypx" path="res://Props/Furniture/Pc Tower.tscn" id="6_5rrr5"]
[ext_resource type="PackedScene" uid="uid://chj024exmu62m" path="res://Props/Furniture/FishTank.tscn" id="6_tj5wv"]
[ext_resource type="PackedScene" uid="uid://dnj5dml3k3kyj" path="res://Props/Furniture/Tank Cabinet.tscn" id="10_133si"]
[ext_resource type="PackedScene" uid="uid://dua5jf8k4h2fm" path="res://Props/Furniture/ComputerMonitor.tscn" id="11_b10nm"]
[ext_resource type="PackedScene" uid="uid://bgqd2kekjo8bh" path="res://Scenes/HUD.tscn" id="11_esopp"]
[ext_resource type="PackedScene" uid="uid://uonykcfne10p" path="res://Props/Furniture/Bed.tscn" id="13_bktio"]
[ext_resource type="PackedScene" uid="uid://di34543g8ec07" path="res://Props/Furniture/Shelf.tscn" id="13_fhlu0"]
[ext_resource type="PackedScene" uid="uid://bmuexnk85c7i6" path="res://Props/Furniture/Desk.tscn" id="13_pmxqn"]
[ext_resource type="PackedScene" uid="uid://nk8ivrrkkcyd" path="res://Props/Furniture/Cat Bed.tscn" id="15_g4pvc"]
[ext_resource type="PackedScene" uid="uid://dgbjth6ura5xo" path="res://Props/Fork.tscn" id="15_nrlyp"]
[ext_resource type="PackedScene" uid="uid://clrkhspy125jv" path="res://Props/Tennisball.tscn" id="16_44tr1"]
[ext_resource type="PackedScene" uid="uid://b18tj46hdfr2m" path="res://Props/Furniture/Lamp.tscn" id="16_ifohm"]
[ext_resource type="PackedScene" uid="uid://u6e5cg4yu4b3" path="res://Props/Window.tscn" id="17_pmxqn"]
[ext_resource type="PackedScene" uid="uid://b85hievt11q0l" path="res://Cat/Cat.tscn" id="19_ifohm"]
[ext_resource type="PackedScene" uid="uid://buxxeh4m5q3wf" path="res://Props/Skateboard.tscn" id="20_yyp3s"]
[ext_resource type="PackedScene" uid="uid://cqu4xeiouelql" path="res://Props/Furniture/Fan.tscn" id="21_g4pvc"]
[ext_resource type="Script" uid="uid://w3rojc3jygsq" path="res://Scripts/InteractSnapPoint.gd" id="21_yyp3s"]
[ext_resource type="PackedScene" uid="uid://cqrht4tcc2mh1" path="res://Props/Furniture/Sidetable.tscn" id="22_g4pvc"]
[ext_resource type="PackedScene" uid="uid://papj5ph5uj3o" path="res://Props/Noodle.tscn" id="24_17mqb"]

[sub_resource type="NavigationMesh" id="NavigationMesh_g4pvc"]
vertices = PackedVector3Array(-10.417055, 0.27799988, -3.9839993, -10.167055, 0.27799988, -3.9839993, -9.917055, 0.27799988, -5.2339993, -10.667055, 0.27799988, -5.2339993, -7.417055, 0.27799988, -5.9839993, -6.417055, 0.27799988, -5.2339993, -5.917055, 0.27799988, -9.733999, -9.417055, 0.27799988, -11.233999, -10.417055, 0.27799988, -13.483999, -10.667055, 0.27799988, -11.733999, -8.917055, 0.27799988, -5.9839993, -11.917055, 0.27799988, -5.9839993, -7.167055, 0.27799988, -10.483999, -7.167055, 0.27799988, -10.983999, -11.917055, 0.27799988, -10.983999, 3.3329449, 0.27799988, -13.483999, -0.41705513, 0.27799988, -13.483999, -0.41705513, 0.27799988, -10.983999, 4.082945, 0.27799988, -12.733999, 8.332945, 0.27799988, -4.2339993, 12.082945, 0.27799988, -12.733999, 7.082945, 0.27799988, -3.2339993, -1.1670551, 0.27799988, -9.983999, -6.167055, 0.27799988, -3.2339993, 6.832945, 0.27799988, -2.2339993, -6.917055, 0.27799988, -2.2339993, 12.082945, 0.27799988, -4.2339993, -10.667055, 0.27799988, -2.7339993, -9.417055, 0.27799988, -2.2339993, -11.917055, 0.27799988, 9.516001, -10.667055, 0.27799988, 10.516001, -6.417055, 0.27799988, 10.516001, -5.167055, 0.27799988, 9.266001, -11.917055, 0.27799988, -1.9839993, -10.667055, 0.27799988, 13.516001, -6.417055, 0.27799988, 13.516001, 0.33294487, 0.27799988, 9.516001, 7.082945, 0.27799988, 3.0160007, 10.582945, 0.5279999, -0.98399925, 10.582945, 0.5279999, 1.0160007, 11.832945, 0.5279999, 1.0160007, 11.832945, 0.5279999, -0.98399925, 10.582945, 4.028, -0.98399925, 10.582945, 4.028, 1.0160007, 11.832945, 4.028, 1.0160007, 11.832945, 4.028, -0.98399925, 1.3329449, 0.27799988, 10.516001, 8.332945, 0.27799988, 4.2660007, 12.082945, 0.27799988, 13.516001, 12.082945, 0.27799988, 4.2660007, 1.0829449, 0.27799988, 13.516001, -2.9170551, 8.028, 12.266001, -2.6670551, 8.028, 13.016001, -2.1670551, 8.028, 12.766001, -2.4170551, 8.028, 12.016001, -9.167055, 4.778, 13.516001, -5.917055, 4.778, 13.516001, -6.417055, 4.778, 12.266001, -9.167055, 4.778, 12.266001)
polygons = [PackedInt32Array(0, 3, 1), PackedInt32Array(1, 3, 2), PackedInt32Array(6, 5, 4), PackedInt32Array(9, 8, 7), PackedInt32Array(2, 3, 10), PackedInt32Array(10, 3, 11), PackedInt32Array(7, 13, 12), PackedInt32Array(14, 9, 7), PackedInt32Array(6, 4, 10), PackedInt32Array(12, 6, 7), PackedInt32Array(7, 6, 14), PackedInt32Array(14, 6, 10), PackedInt32Array(14, 10, 11), PackedInt32Array(15, 18, 16), PackedInt32Array(16, 18, 17), PackedInt32Array(21, 18, 19), PackedInt32Array(19, 18, 20), PackedInt32Array(17, 18, 22), PackedInt32Array(22, 18, 21), PackedInt32Array(22, 21, 24), PackedInt32Array(22, 24, 23), PackedInt32Array(5, 6, 23), PackedInt32Array(23, 6, 22), PackedInt32Array(24, 25, 23), PackedInt32Array(20, 26, 19), PackedInt32Array(0, 1, 27), PackedInt32Array(27, 1, 28), PackedInt32Array(30, 29, 31), PackedInt32Array(31, 29, 32), PackedInt32Array(32, 29, 25), PackedInt32Array(25, 29, 33), PackedInt32Array(33, 27, 28), PackedInt32Array(33, 28, 25), PackedInt32Array(31, 35, 30), PackedInt32Array(30, 35, 34), PackedInt32Array(37, 36, 24), PackedInt32Array(24, 36, 32), PackedInt32Array(24, 32, 25), PackedInt32Array(41, 40, 38), PackedInt32Array(38, 40, 39), PackedInt32Array(45, 44, 42), PackedInt32Array(42, 44, 43), PackedInt32Array(36, 37, 46), PackedInt32Array(46, 37, 47), PackedInt32Array(49, 48, 47), PackedInt32Array(47, 48, 46), PackedInt32Array(46, 48, 50), PackedInt32Array(54, 53, 51), PackedInt32Array(51, 53, 52), PackedInt32Array(58, 57, 55), PackedInt32Array(55, 57, 56)]
agent_radius = 1.5
agent_max_climb = 1.5
agent_max_slope = 0.02

[sub_resource type="Animation" id="Animation_g4pvc"]
length = 0.001
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("NavigationRegion3D/Furniture/Fishtank:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0),
"transitions": PackedFloat32Array(1),
"update": 0,
"values": [Vector3(10.395266, 7.2147493, 0.12627697)]
}

[sub_resource type="Animation" id="Animation_yyp3s"]
resource_name = "pry_down_fishtank"
length = 1.2333
tracks/0/type = "value"
tracks/0/imported = false
tracks/0/enabled = true
tracks/0/path = NodePath("Fishtank Pry Point:position")
tracks/0/interp = 1
tracks/0/loop_wrap = true
tracks/0/keys = {
"times": PackedFloat32Array(0, 0.7),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector3(8.129375, 7.4668508, 0), Vector3(8.073276, 7.2920237, 0)]
}
tracks/1/type = "value"
tracks/1/imported = false
tracks/1/enabled = true
tracks/1/path = NodePath("Fishtank Pry Point:rotation")
tracks/1/interp = 1
tracks/1/loop_wrap = true
tracks/1/keys = {
"times": PackedFloat32Array(0, 0.7),
"transitions": PackedFloat32Array(1, 1),
"update": 0,
"values": [Vector3(-0.5050284, -1.5707964, 2.4165827e-08), Vector3(-0.23436284, -1.5707964, 1.2150107e-08)]
}
tracks/2/type = "method"
tracks/2/imported = false
tracks/2/enabled = true
tracks/2/path = NodePath(".")
tracks/2/interp = 1
tracks/2/loop_wrap = true
tracks/2/keys = {
"times": PackedFloat32Array(0.7, 1.2290611),
"transitions": PackedFloat32Array(1, 1),
"values": [{
"args": [],
"method": &"release_fork"
}, {
"args": [],
"method": &"finish_prying"
}]
}
tracks/3/type = "value"
tracks/3/imported = false
tracks/3/enabled = true
tracks/3/path = NodePath("NavigationRegion3D/Furniture/Fishtank:position")
tracks/3/interp = 1
tracks/3/loop_wrap = true
tracks/3/keys = {
"times": PackedFloat32Array(0, 0.70275676, 0.7633393, 0.8521936, 1.2333),
"transitions": PackedFloat32Array(1, 1, 1, 1, 1),
"update": 0,
"values": [Vector3(10.395266, 7.2147493, 0.12627697), Vector3(10.395266, 7.2147493, 0.12627697), Vector3(8.323451, 7.412936, 0.12627697), Vector3(6.814401, 7.166525, 0.12627697), Vector3(5.9028044, 0.44075966, 0.12627697)]
}

[sub_resource type="AnimationLibrary" id="AnimationLibrary_ifohm"]
_data = {
&"RESET": SubResource("Animation_g4pvc"),
&"pry_down_fishtank": SubResource("Animation_yyp3s")
}

[sub_resource type="SphereShape3D" id="SphereShape3D_32npc"]
radius = 2.2487152

[sub_resource type="BoxShape3D" id="BoxShape3D_g4pvc"]
size = Vector3(0.96868896, 1.503479, 4.161255)

[node name="Level" type="Node3D" groups=["gamemanager"]]
script = ExtResource("1_or7tv")
lives = 10
win_flags = Array[String](["window", "ramp", "fishtank", "fan"])

[node name="Cat Bed" parent="." instance=ExtResource("15_g4pvc")]
transform = Transform3D(0.59233665, 0, -0.80569065, 0, 1, 0, 0.80569065, 0, 0.59233665, 9.802208, 0.69185835, 11.550291)

[node name="NavigationRegion3D" type="NavigationRegion3D" parent="."]
navigation_mesh = SubResource("NavigationMesh_g4pvc")

[node name="BEDROOM" parent="NavigationRegion3D" instance=ExtResource("1_vonw3")]

[node name="Furniture" type="Node3D" parent="NavigationRegion3D"]

[node name="PcTower" parent="NavigationRegion3D/Furniture" instance=ExtResource("6_5rrr5")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -11.984297, 4.290952, 12.826541)
collision_mask = 3

[node name="Fishtank" parent="NavigationRegion3D/Furniture" instance=ExtResource("6_tj5wv")]
transform = Transform3D(-1, 0, -8.742278e-08, 0, 1, 0, 8.742278e-08, 0, -1, 10.395266, 7.2147493, 0.12627697)

[node name="Player Spawn Point" type="RayCast3D" parent="NavigationRegion3D/Furniture/Fishtank"]
transform = Transform3D(-4.3711385e-08, 0, 0.99999994, 0, 1, 0, -0.99999994, 0, -4.3711385e-08, 3.8108816, 3.2215662, 0.1262773)
target_position = Vector3(0, -18.195, 0)
hit_from_inside = true

[node name="Spawn Cam" type="Camera3D" parent="NavigationRegion3D/Furniture/Fishtank"]
transform = Transform3D(1.2354687e-07, -0.56305003, 0.8264228, 2.4611692e-08, 0.8264228, 0.56305003, -1, -4.922341e-08, 1.1595957e-07, 5.812564, 4.558217, 0.2787775)

[node name="Tank Cabinet" parent="NavigationRegion3D/Furniture" instance=ExtResource("10_133si")]
transform = Transform3D(-4.371139e-08, 0, -1, 0, 1, 0, 1, 0, -4.371139e-08, 11.136, 0.01, 0)

[node name="Computer Monitor" parent="NavigationRegion3D/Furniture" instance=ExtResource("11_b10nm")]
transform = Transform3D(-0.7242559, 0, -0.68953097, 0, 1, 0, 0.68953097, 0, -0.7242559, -2.6106548, 4.521897, 12.409892)

[node name="Shelf" parent="NavigationRegion3D/Furniture" instance=ExtResource("13_fhlu0")]
transform = Transform3D(-4.371139e-08, 0, -1, 0, 1, 0, 1, 0, -4.371139e-08, -12.629552, 8.992483, -0.5497494)

[node name="Shelf2" parent="NavigationRegion3D/Furniture" instance=ExtResource("13_fhlu0")]
transform = Transform3D(-4.371139e-08, 0, -1, 0, 1, 0, 1, 0, -4.371139e-08, -12.629552, 13.3520975, 5.7196636)

[node name="Bed" parent="NavigationRegion3D/Furniture" instance=ExtResource("13_bktio")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -10.313006, 0.73873395, -8.593045)

[node name="Window" parent="NavigationRegion3D/Furniture" instance=ExtResource("17_pmxqn")]
transform = Transform3D(-1, 0, -8.742278e-08, 0, 1, 0, 8.742278e-08, 0, -1, -2.4152193, 8.027436, 15.422432)

[node name="Desk" parent="NavigationRegion3D/Furniture" instance=ExtResource("13_pmxqn")]
transform = Transform3D(-1, 0, -8.742278e-08, 0, 1, 0, 8.742278e-08, 0, -1, -6.4859395, -0.15982816, 15.008742)

[node name="Fan" parent="NavigationRegion3D/Furniture" instance=ExtResource("21_g4pvc")]
transform = Transform3D(0.85862905, 0, -0.51259744, 0, 1, 0, 0.51259744, 0, 0.85862905, -3.8499284, 4.2882533, -12.990915)
mass = 4.0

[node name="Lamp" parent="NavigationRegion3D/Furniture" instance=ExtResource("16_ifohm")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -11.789153, 10.203918, -2.042945)

[node name="Sidetable" parent="NavigationRegion3D/Furniture" instance=ExtResource("22_g4pvc")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -3.9774616, 1.899898e-07, -13.21769)

[node name="Ambiance" type="AudioStreamPlayer" parent="."]
stream = ExtResource("5_f2txt")
volume_db = 3.636
autoplay = true
bus = &"SFX"

[node name="Music" type="AudioStreamPlayer" parent="."]
stream = ExtResource("6_1ainy")
volume_db = -20.363
autoplay = true
bus = &"Music"

[node name="CanvasLayer" type="CanvasLayer" parent="."]
follow_viewport_enabled = true

[node name="HUD" parent="CanvasLayer" instance=ExtResource("11_esopp")]

[node name="AnimationPlayer" type="AnimationPlayer" parent="."]
libraries = {
&"": SubResource("AnimationLibrary_ifohm")
}

[node name="Skateboard fishtank Area" type="Area3D" parent="."]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Skateboard fishtank Area"]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 6.1983166, 0, 0)
shape = SubResource("SphereShape3D_32npc")
debug_color = Color(0.9492838, 6.3532593e-06, 0.57661045, 0.41960785)

[node name="Fishtank Pry Point" type="Node3D" parent="."]
transform = Transform3D(-3.201918e-08, 0.4838323, -0.87516063, 2.1148981e-08, 0.87516063, 0.4838323, 1, -3.0168434e-09, -3.8254484e-08, 8.129375, 7.4668508, 0)
script = ExtResource("21_yyp3s")
item_group = "fork"

[node name="Area3D" type="Area3D" parent="Fishtank Pry Point"]

[node name="CollisionShape3D" type="CollisionShape3D" parent="Fishtank Pry Point/Area3D"]
transform = Transform3D(-3.825449e-08, 2.1148981e-08, 1, 0.4838323, 0.87516075, -7.775593e-16, -0.87516075, 0.4838323, -4.371149e-08, 0.007873519, 0.085826874, -0.35638976)
shape = SubResource("BoxShape3D_g4pvc")
debug_color = Color(0.9629546, 6.738305e-07, 0.5043789, 0.41960785)

[node name="OmniLight3D" type="OmniLight3D" parent="."]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 11.594242, 0)
omni_range = 4096.0

[node name="Cat" parent="." instance=ExtResource("19_ifohm")]
transform = Transform3D(-0.69542384, 0, -0.71859986, 0, 1, 0, 0.71859986, 0, -0.69542384, 9.508078, 0.46746916, 11.102701)

[node name="Screwdriver" parent="." instance=ExtResource("3_oi3di")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -2.7763972, 1.1786723, 12.970981)

[node name="Fork" parent="." instance=ExtResource("15_nrlyp")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -5.75747, 5.5548515, 11.06062)

[node name="Tennisball" parent="." instance=ExtResource("16_44tr1")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -9, 10, 3)

[node name="Skateboard home" type="Node3D" parent="."]
transform = Transform3D(0.78521967, 0, -0.61921734, 0, 1, 0, 0.61921734, 0, 0.78521967, -4.2189646, 0.41812587, -8.160702)

[node name="Skateboard" parent="Skateboard home" instance=ExtResource("20_yyp3s")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, 0, 0.0879851, 0)

[node name="Noodle" parent="." node_paths=PackedStringArray("fork") instance=ExtResource("24_17mqb")]
transform = Transform3D(1, 0, 0, 0, 1, 0, 0, 0, 1, -5.758637, 4.9549856, 11.175354)
fork = NodePath("../Fork")

[connection signal="jump_out_of_tank" from="." to="NavigationRegion3D/Furniture/Fishtank" method="play_jump_animation"]
[connection signal="jump_out_of_tank" from="." to="CanvasLayer/HUD" method="fade_out_prompt"]
[connection signal="prying_done" from="." to="NavigationRegion3D/Furniture/Fishtank" method="switch_spawn_animation"]
[connection signal="prying_done" from="." to="Skateboard home/Skateboard" method="acquire_fishtank"]
[connection signal="update_game_state" from="." to="CanvasLayer/HUD" method="toggle_game_ui"]
[connection signal="update_timer" from="." to="CanvasLayer/HUD" method="update_breath_timer"]
[connection signal="animation_finished" from="NavigationRegion3D/Furniture/Fishtank" to="." method="go_to_playing_state"]
[connection signal="hit_glass" from="NavigationRegion3D/Furniture/Computer Monitor" to="NavigationRegion3D/Furniture/Window" method="shatter"]
[connection signal="raise_window_flag" from="NavigationRegion3D/Furniture/Window" to="." method="add_global_flag"]
[connection signal="set_up_ramp" from="NavigationRegion3D/Furniture/Desk" to="." method="add_global_flag"]
[connection signal="attempt_win" from="NavigationRegion3D/Furniture/Fan" to="." method="check_if_win"]
[connection signal="body_entered" from="Skateboard fishtank Area" to="." method="_on_skateboard_fishtank_area_body_entered"]
[connection signal="body_exited" from="Skateboard fishtank Area" to="." method="_on_skateboard_fishtank_area_body_exited"]
[connection signal="snap_point_filled" from="Fishtank Pry Point" to="." method="_on_fork_point_filled"]
[connection signal="body_entered" from="Fishtank Pry Point/Area3D" to="Fishtank Pry Point" method="_on_area_3d_body_entered"]
[connection signal="fan_picked_up" from="Skateboard home/Skateboard" to="." method="add_global_flag"]
